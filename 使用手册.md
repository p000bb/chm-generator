# CHM文档生成工具 使用手册

## 📖 产品概述

**CHM文档生成工具** 是一款专业的帮助文档生成解决方案，专为国民技术微控制器产品设计。该工具能够将芯片相关的技术文档、示例代码、应用笔记等资源自动整合，生成标准化的CHM（Compiled HTML Help）帮助文档。

## 🚀 快速开始

### 系统要求

- **操作系统**：Windows 10/11 (64位)
- **内存**：建议 8GB 以上
- **存储空间**：至少 2GB 可用空间
- **网络**：需要互联网连接（用于文档翻译和下载）

### 安装步骤

1. **下载安装包**
   - 从edoc平台获取 `CHM文档生成工具.exe` 安装包
   - 确保下载的是最新版本

2. **运行安装程序**
   - 双击 `CHM文档生成工具.exe` 开始安装
   - 按照安装向导提示完成安装
   - 建议安装到默认路径

3. **启动应用**
   - 安装完成后，桌面会出现应用图标
   - 双击图标启动应用
   - 首次启动可能需要几秒钟初始化时间

## 📋 使用指南

### 基本使用流程

> 🚀 **快速开始**：如果您是首次使用，建议直接按照以下步骤操作：
> 1. 选择输入源文件夹和输出目标文件夹
> 2. 填写芯片配置信息
> 3. 在组合脚本模式下，直接点击"运行选中脚本"
> 4. 等待约26分钟，即可获得完整的CHM文档

#### 1. 配置输入和输出路径

**输入源文件夹**：
- 点击"选择文件夹"按钮
- 选择包含芯片文档的源文件夹
- 该文件夹应包含以下结构：
  ```
  源文件夹/
  ├── 1-Product_Brief
  ├── 2-Datasheet
  ├── 3-User_Manual
  └── 4-Errata_Sheet
  └── 5-Hardware_Evaluation_Board
  └── 6-Software_Development_Kit
  └── 7-Application_Note
  └── 8-User_Guide
  ```

**芯片配置**：
- 填写芯片名称（如：N32G4FRxx）
- 填写芯片版本（如：V3.3.0）
- 填写相关网址和下载链接
- 也可以选择配置参考选择已经配置好的芯片模板

**输出目标文件夹**：
- 选择CHM文档的输出位置
- 确保有足够的磁盘空间（建议至少1GB）

#### 2. 选择执行模式

**组合脚本模式**（推荐）：
- 包含完整的文档生成流程
- 适合大多数用户使用
- **简化使用**：直接选择4个主要步骤，一键完成整个CHM文档生成
- 包含4个主要步骤：
  1. 解压源文件
  2. Overview模块构建
  3. 子模块构建
  4. 构建CHM

**单独脚本模式**：
- 可以单独执行某个特定功能
- 适合高级用户或调试使用
- 包含14个独立脚本

#### 3. 执行文档生成

1. **选择脚本**：
   - **组合脚本模式**（推荐）：默认全选4个步骤，直接点击"运行选中脚本"即可完成整个CHM文档生成
   - 可以取消勾选不需要的步骤（如只需要部分功能）
   - **单独脚本模式**：选择需要执行的特定脚本

2. **开始执行**：
   - 点击"运行选中脚本"按钮
   - 系统会显示执行进度
   - 可以随时点击"取消执行"停止

3. **监控进度**：
   - 实时查看当前执行的脚本
   - 查看执行状态（成功/失败）
   - 在"运行日志"页面查看详细信息

> 💡 **快速使用提示**：对于大多数用户，建议使用组合脚本模式，直接运行4个默认选中的步骤，无需额外配置即可生成完整的CHM文档。


### 详细功能说明

#### 组合脚本详解

> 📝 **说明**：组合脚本模式包含4个主要步骤，默认全部选中。用户可以直接运行这4个步骤，无需额外配置即可完成整个CHM文档生成流程。

**1. 解压源文件**
- **功能**：自动解压输入文件夹中的所有ZIP文件
- **时间**：约1分钟
- **输出**：解压后的文档文件
- **必需**：✅ 必须执行

**2. Overview模块构建**
- **功能**：生成主文档的Overview页面
- **包含脚本**：
  - `docs_gen_main_html`：生成主HTML文件
  - `generate_modules`：生成模块文档
  - `get_chip_data`：获取芯片数据
  - `translate_main_modules`：翻译主模块
  - `docs_main_doxygen`：主Doxygen文档生成
  - `docs_gen_config`：生成配置文件
- **时间**：约5分钟
- **必需**：✅ 必须执行

**3. 子模块构建**
- **功能**：按照目录结构生成子模块的HTML文件
- **包含脚本**：
  - `docs_gen_doxyfile`：生成Doxygen配置
  - `docs_gen_doxygen`：生成Doxygen文档
  - `docs_gen_pdfhtml`：生成PDF HTML文件
  - `docs_gen_examples`：生成示例文档
  - `docs_gen_examples_overview`：生成示例概览
  - `docs_gen_examples_description`：生成示例描述
- **时间**：约10分钟
- **必需**：✅ 必须执行

**4. 构建CHM**
- **功能**：将前面生成的文件编译成最终的CHM文档
- **包含脚本**：
  - `docs_gen_template_hhc`：生成HHC模板
  - `docs_gen_hhc`：生成HHC文件
  - `docs_gen_hhp`：生成HHP文件
  - `generate_chm_hhc`：生成最终CHM文件
- **时间**：约10分钟
- **必需**：✅ 必须执行

> ⏱️ **总执行时间**：约26分钟（1+5+10+10分钟）

#### 单独脚本功能

> 📝 **说明**：单独脚本模式适合高级用户或需要调试特定功能的场景。每个脚本都可以独立运行，但建议按照组合脚本的顺序执行以确保完整性。

| 脚本名称                        | 功能描述          | 执行时间 | 所属步骤 |
| ------------------------------- | ----------------- | -------- | -------- |
| `docs_decompression`            | 解压ZIP文件       | 1分钟    | 步骤1    |
| `docs_gen_main_html`            | 生成主HTML文件    | 30秒     | 步骤2    |
| `generate_modules`              | 生成模块文档      | 1分钟    | 步骤2    |
| `get_chip_data`                 | 获取芯片数据      | 1分钟    | 步骤2    |
| `translate_main_modules`        | 翻译主模块        | 2分钟    | 步骤2    |
| `docs_main_doxygen`             | 主Doxygen文档生成 | 1分钟    | 步骤2    |
| `docs_gen_config`               | 生成配置文件      | 30秒     | 步骤2    |
| `docs_gen_doxyfile`             | 生成Doxyfile配置  | 30秒     | 步骤3    |
| `docs_gen_doxygen`              | 生成Doxygen文档   | 5分钟    | 步骤3    |
| `docs_gen_pdfhtml`              | 生成PDF HTML文件  | 1分钟    | 步骤3    |
| `docs_gen_examples`             | 生成示例文档      | 2分钟    | 步骤3    |
| `docs_gen_examples_overview`    | 生成示例概览      | 1分钟    | 步骤3    |
| `docs_gen_examples_description` | 生成示例描述      | 1分钟    | 步骤3    |
| `docs_gen_template_hhc`         | 生成HHC模板       | 1分钟    | 步骤4    |
| `docs_gen_hhc`                  | 生成HHC文件       | 1分钟    | 步骤4    |
| `docs_gen_hhp`                  | 生成HHP文件       | 30秒     | 步骤4    |
| `generate_chm_hhc`              | 生成最终CHM文件   | 5分钟    | 步骤4    |

## ⚙️ 配置管理

### 芯片配置

在"配置管理"页面，您可以：

1. **编辑基础配置**：
   - 修改下载URL
   - 更新会话ID
   - 调整技术术语翻译

2. **管理文档类型**：
   - 产品简介
   - 数据手册
   - 用户手册
   - 勘误手册
   - 硬件评估板
   - 软件开发包
   - 应用笔记
   - 使用指南

3. **自定义翻译**：
   - 添加新的技术术语
   - 修改现有翻译
   - 导入/导出翻译配置

### 路径配置

- **输入路径**：设置默认的源文档路径
- **输出路径**：设置默认的CHM输出路径
- **临时路径**：设置临时文件存储路径

## 📊 运行日志

### 日志功能

在"运行日志"页面，您可以：

1. **查看执行历史**：
   - 所有脚本的执行记录
   - 成功/失败状态
   - 执行时间统计

2. **实时监控**：
   - 当前执行脚本的输出
   - 错误信息和警告
   - 进度百分比

3. **日志导出**：
   - 导出日志到文本文件
   - 保存执行报告
   - 分享给技术支持

### 日志级别

- **INFO**：一般信息
- **WARNING**：警告信息
- **ERROR**：错误信息
