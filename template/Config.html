<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=8,IE=9,IE=10,IE=11" />
    <title>èŠ¯ç‰‡æ–‡æ¡£åŸºè·¯å¾„è®¾ç½®å™¨</title>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
        font-family: Arial, sans-serif;
      }
      .container {
        width: 100%;
        height: 100%;
        border: none;
        position: relative;
        background: #f5f5f5;
      }
      .input-panel {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        text-align: center;
        min-width: 600px;
      }
      .header-section {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        /* IE8å…¼å®¹ */
        zoom: 1;
      }
      .header-section h2 {
        margin: 0;
        color: #333;
        flex: 1;
        text-align: left;
      }
      .language-selector {
        display: inline-block;
        margin-left: 20px;
        /* IE8å…¼å®¹ */
        zoom: 1;
      }
      .language-selector select {
        padding: 8px 12px;
        border: 2px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
        background: white;
        cursor: pointer;
        /* IE8å…¼å®¹ */
        zoom: 1;
      }
      .language-selector select:focus {
        outline: none;
        border-color: #4caf50;
      }
      .input-panel h2 {
        margin: 0 0 20px 0;
        color: #333;
      }
      .input-group {
        margin-bottom: 20px;
        text-align: left;
      }
      .input-group label {
        display: block;
        margin-bottom: 8px;
        color: #555;
        font-weight: bold;
      }
      .path-input-container {
        display: block;
        margin-bottom: 15px;
        /* IE8å…¼å®¹ */
        zoom: 1;
      }
      .path-input-container input {
        width: 100%;
        padding: 12px;
        border: 2px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
        box-sizing: border-box;
        font-family: "Courier New", monospace;
        margin-bottom: 10px;
        /* IE8å…¼å®¹çš„è¡Œå†…å—æ˜¾ç¤º */
        display: inline;
        zoom: 1;
      }
      .path-input-container input:focus {
        outline: none;
        border-color: #4caf50;
      }
      .browse-btn {
        background: #2196f3;
        color: white;
        padding: 12px 20px;
        border: none;
        border-radius: 4px;
        font-size: 14px;
        cursor: pointer;
        transition: background 0.3s;
        /* IE8å…¼å®¹ */
        zoom: 1;
        width: 15%;
        margin-bottom: 0;
        float: right;
        white-space: nowrap;
      }
      .browse-btn:hover {
        background: #1976d2;
      }
      .browse-btn:active {
        background: #1565c0;
      }
      .btn {
        background: #4caf50;
        color: white;
        padding: 12px 30px;
        border: none;
        border-radius: 4px;
        font-size: 16px;
        cursor: pointer;
        transition: background 0.3s;
        margin: 5px;
        display: inline-block;
      }
      .btn:hover {
        background: #45a049;
      }
      .btn:active {
        background: #3d8b40;
      }
      .btn-clear {
        background: #dc3545;
        margin-left: 10px;
      }
      .btn-clear:hover {
        background: #c82333;
      }
      .btn-clear:active {
        background: #bd2130;
      }
      .message {
        margin-top: 15px;
        padding: 10px;
        border-radius: 4px;
        font-size: 14px;
      }
      .message.success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .message.error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .info-box {
        background: #e3f2fd;
        border: 1px solid #bbdefb;
        border-radius: 4px;
        padding: 15px;
        margin-bottom: 20px;
        text-align: left;
      }
      .info-box h3 {
        margin: 0 0 10px 0;
        color: #1976d2;
        font-size: 16px;
      }
      .info-box p {
        margin: 5px 0;
        color: #424242;
        font-size: 14px;
        line-height: 1.4;
      }
      .path-display {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 10px;
        margin: 15px 0;
        font-family: "Courier New", monospace;
        font-size: 12px;
        color: #495057;
        word-break: break-all;
        text-align: left;
      }
      .button-group {
        margin-top: 20px;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="input-panel">
        <div class="header-section">
          <h2
            data-en="ğŸ“ CHM Chip Document Base Path Setter"
            data-cn="ğŸ“ CHM èŠ¯ç‰‡æ–‡æ¡£åŸºè·¯å¾„è®¾ç½®å™¨"
          >
            ğŸ“ CHM èŠ¯ç‰‡æ–‡æ¡£åŸºè·¯å¾„è®¾ç½®å™¨
          </h2>
          <div class="language-selector">
            <select id="languageSelect" onchange="switchLanguage()">
              <option value="cn">ä¸­æ–‡</option>
              <option value="en">English</option>
            </select>
          </div>
        </div>

        <div
          class="info-box"
          style="background: #fff3cd; border-color: #ffeaa7"
        >
          <h3 data-en="ğŸ¯ Purpose" data-cn="ğŸ¯ ä½¿ç”¨ç›®çš„">ğŸ¯ ä½¿ç”¨ç›®çš„</h3>
          <p
            data-en="This tool is specifically designed to address the need for viewing local PDF documents in offline environments. By configuring the local storage path for chip documents, you can quickly access and review technical materials in offline mode."
            data-cn="æœ¬å·¥å…·ä¸“ä¸ºè§£å†³æ— ç½‘ç»œç¯å¢ƒä¸‹çš„æœ¬åœ°PDFæ–‡æ¡£æŸ¥çœ‹éœ€æ±‚è€Œè®¾è®¡ã€‚é€šè¿‡é…ç½®èŠ¯ç‰‡æ–‡æ¡£çš„æœ¬åœ°å­˜å‚¨è·¯å¾„ï¼Œæ‚¨å¯ä»¥åœ¨ç¦»çº¿çŠ¶æ€ä¸‹å¿«é€Ÿè®¿é—®å’ŒæŸ¥é˜…æŠ€æœ¯èµ„æ–™ã€‚"
          >
            æœ¬å·¥å…·ä¸“ä¸ºè§£å†³æ— ç½‘ç»œç¯å¢ƒä¸‹çš„æœ¬åœ°PDFæ–‡æ¡£æŸ¥çœ‹éœ€æ±‚è€Œè®¾è®¡ã€‚é€šè¿‡é…ç½®èŠ¯ç‰‡æ–‡æ¡£çš„æœ¬åœ°å­˜å‚¨è·¯å¾„ï¼Œæ‚¨å¯ä»¥åœ¨ç¦»çº¿çŠ¶æ€ä¸‹å¿«é€Ÿè®¿é—®å’ŒæŸ¥é˜…æŠ€æœ¯èµ„æ–™ã€‚
          </p>
        </div>

        <div class="info-box">
          <h3 data-en="ğŸ’¡ Instructions" data-cn="ğŸ’¡ ä½¿ç”¨è¯´æ˜">ğŸ’¡ ä½¿ç”¨è¯´æ˜</h3>
          <p
            data-en="1. Click the 'Browse' button to see how to get the path"
            data-cn="1. ç‚¹å‡»'æµè§ˆ'æŒ‰é’®æŸ¥çœ‹å¦‚ä½•è·å–è·¯å¾„"
          >
            1. ç‚¹å‡»"æµè§ˆ"æŒ‰é’®æŸ¥çœ‹å¦‚ä½•è·å–è·¯å¾„
          </p>
          <p
            data-en="2. Navigate to the chip series folder in File Explorer"
            data-cn="2. åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­å¯¼èˆªåˆ°èŠ¯ç‰‡ç³»åˆ—çš„æ–‡ä»¶å¤¹"
          >
            2. åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­å¯¼èˆªåˆ°èŠ¯ç‰‡ç³»åˆ—çš„æ–‡ä»¶å¤¹
          </p>
          <p
            data-en="3. Copy the folder path (path in the address bar)"
            data-cn="3. å¤åˆ¶æ–‡ä»¶å¤¹è·¯å¾„ï¼ˆåœ°å€æ ä¸­çš„è·¯å¾„ï¼‰"
          >
            3. å¤åˆ¶æ–‡ä»¶å¤¹è·¯å¾„ï¼ˆåœ°å€æ ä¸­çš„è·¯å¾„ï¼‰
          </p>
          <p
            data-en="4. Paste it into the input box below"
            data-cn="4. ç²˜è´´åˆ°ä¸‹é¢çš„è¾“å…¥æ¡†ä¸­"
          >
            4. ç²˜è´´åˆ°ä¸‹é¢çš„è¾“å…¥æ¡†ä¸­
          </p>
          <p
            data-en="5. Click the 'Save Base Path' button"
            data-cn="5. ç‚¹å‡»'ä¿å­˜åŸºè·¯å¾„'æŒ‰é’®"
          >
            5. ç‚¹å‡»"ä¿å­˜åŸºè·¯å¾„"æŒ‰é’®
          </p>
        </div>

        <div class="input-group">
          <label
            for="pdfPath"
            data-en="Chip Document Base Path:"
            data-cn="èŠ¯ç‰‡æ–‡æ¡£åŸºè·¯å¾„ï¼š"
            >èŠ¯ç‰‡æ–‡æ¡£åŸºè·¯å¾„ï¼š</label
          >
          <div class="path-input-container">
            <input
              type="text"
              id="pdfPath"
              placeholder="ä¾‹å¦‚ï¼šD:\NS3608\N32H48xxx_V1.1.0"
              value=""
              style="
                display: inline-block;
                width: 80%;
                margin-right: 10px;
                margin-bottom: 0;
              "
            />
            <button
              class="browse-btn"
              onclick="browseFolder()"
              data-en="ğŸ“ Browse"
              data-cn="ğŸ“ æµè§ˆ"
            >
              ğŸ“ æµè§ˆ
            </button>
          </div>
        </div>

        <div id="currentPath" class="path-display" style="display: none">
          <strong data-en="Set Base Path:" data-cn="è®¾ç½®çš„åŸºè·¯å¾„ï¼š"
            >è®¾ç½®çš„åŸºè·¯å¾„ï¼š</strong
          ><br />
          <span id="pathText"></span>
        </div>

        <div class="button-group">
          <button
            class="btn"
            onclick="savePdfPath()"
            data-en="ğŸ’¾ Save Base Path"
            data-cn="ğŸ’¾ ä¿å­˜åŸºè·¯å¾„"
          >
            ğŸ’¾ ä¿å­˜åŸºè·¯å¾„
          </button>
          <button
            class="btn btn-clear"
            onclick="clearPdfPath()"
            data-en="ğŸ—‘ï¸ Clear Base Path"
            data-cn="ğŸ—‘ï¸ æ¸…é™¤åŸºè·¯å¾„"
          >
            ğŸ—‘ï¸ æ¸…é™¤åŸºè·¯å¾„
          </button>
        </div>
        <div id="message" class="message" style="display: none"></div>
      </div>
    </div>

    <script>
      // åŒè¯­å†…å®¹é…ç½®
      var languageConfig = {
        cn: {
          title: "ğŸ“ CHM èŠ¯ç‰‡æ–‡æ¡£åŸºè·¯å¾„è®¾ç½®å™¨",
          purpose: "ğŸ¯ ä½¿ç”¨ç›®çš„",
          purposeText:
            "æœ¬å·¥å…·ä¸“ä¸ºè§£å†³æ— ç½‘ç»œç¯å¢ƒä¸‹çš„æœ¬åœ°PDFæ–‡æ¡£æŸ¥çœ‹éœ€æ±‚è€Œè®¾è®¡ã€‚é€šè¿‡é…ç½®èŠ¯ç‰‡æ–‡æ¡£çš„æœ¬åœ°å­˜å‚¨è·¯å¾„ï¼Œæ‚¨å¯ä»¥åœ¨ç¦»çº¿çŠ¶æ€ä¸‹å¿«é€Ÿè®¿é—®å’ŒæŸ¥é˜…æŠ€æœ¯èµ„æ–™ã€‚",
          instructions: "ğŸ’¡ ä½¿ç”¨è¯´æ˜",
          instruction1: "1. ç‚¹å‡»'æµè§ˆ'æŒ‰é’®æŸ¥çœ‹å¦‚ä½•è·å–è·¯å¾„",
          instruction2: "2. åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­å¯¼èˆªåˆ°èŠ¯ç‰‡ç³»åˆ—çš„æ–‡ä»¶å¤¹",
          instruction3: "3. å¤åˆ¶æ–‡ä»¶å¤¹è·¯å¾„ï¼ˆåœ°å€æ ä¸­çš„è·¯å¾„ï¼‰",
          instruction4: "4. ç²˜è´´åˆ°ä¸‹é¢çš„è¾“å…¥æ¡†ä¸­",
          instruction5: "5. ç‚¹å‡»'ä¿å­˜åŸºè·¯å¾„'æŒ‰é’®",
          basePathLabel: "èŠ¯ç‰‡æ–‡æ¡£åŸºè·¯å¾„ï¼š",
          browseBtn: "ğŸ“ æµè§ˆ",
          setBasePath: "è®¾ç½®çš„åŸºè·¯å¾„ï¼š",
          saveBasePath: "ğŸ’¾ ä¿å­˜åŸºè·¯å¾„",
          clearBasePath: "ğŸ—‘ï¸ æ¸…é™¤åŸºè·¯å¾„",
          clearSuccess: "åŸºè·¯å¾„å·²æˆåŠŸæ¸…é™¤ï¼",
          clearFailed: "æ¸…é™¤å¤±è´¥ï¼è¯·æ£€æŸ¥IEå®‰å…¨è®¾ç½®ã€‚",
          browseMessage:
            "ğŸ“ å¦‚ä½•è·å–æ–‡ä»¶å¤¹è·¯å¾„ï¼š\n\n1. æ‰“å¼€æ–‡ä»¶ç®¡ç†å™¨\n2. å¯¼èˆªåˆ°åŒ…å«èŠ¯ç‰‡æ–‡æ¡£æ–‡ä»¶çš„æ–‡ä»¶å¤¹\n3. åœ¨åœ°å€æ ä¸­å¤åˆ¶å®Œæ•´è·¯å¾„\n4. ç²˜è´´åˆ°ä¸Šé¢çš„è¾“å…¥æ¡†ä¸­\n\nğŸ’¡ æç¤ºï¼š\n- æŒ‰ Ctrl+L å¯ä»¥å¿«é€Ÿé€‰ä¸­åœ°å€æ \n- æŒ‰ Ctrl+C å¤åˆ¶è·¯å¾„\n- æŒ‰ Ctrl+V ç²˜è´´åˆ°è¾“å…¥æ¡†",
          inputRequired: "è¯·è¾“å…¥èŠ¯ç‰‡æ–‡æ¡£åŸºè·¯å¾„ï¼",
          saveSuccess: "èŠ¯ç‰‡æ–‡æ¡£åŸºè·¯å¾„å·²æˆåŠŸä¿å­˜åˆ°æ³¨å†Œè¡¨ï¼",
          saveFailed: "ä¿å­˜å¤±è´¥ï¼è¯·æ£€æŸ¥IEå®‰å…¨è®¾ç½®ã€‚",
          placeholder: "ä¾‹å¦‚ï¼šD:\NS3608\N32H48xxx_V1.1.0",
        },
        en: {
          title: "ğŸ“ CHM Chip Document Base Path Setter",
          purpose: "ğŸ¯ Purpose",
          purposeText:
            "This tool is specifically designed to address the need for viewing local PDF documents in offline environments. By configuring the local storage path for chip documents, you can quickly access and review technical materials in offline mode.",
          instructions: "ğŸ’¡ Instructions",
          instruction1:
            "1. Click the 'Browse' button to see how to get the path",
          instruction2:
            "2. Navigate to the chip series folder in File Explorer",
          instruction3: "3. Copy the folder path (path in the address bar)",
          instruction4: "4. Paste it into the input box below",
          instruction5: "5. Click the 'Save Base Path' button",
          basePathLabel: "Chip Document Base Path:",
          browseBtn: "ğŸ“ Browse",
          setBasePath: "Set Base Path:",
          saveBasePath: "ğŸ’¾ Save Base Path",
          clearBasePath: "ğŸ—‘ï¸ Clear Base Path",
          clearSuccess: "Base path has been successfully cleared!",
          clearFailed: "Clear failed! Please check IE security settings.",
          browseMessage:
            "ğŸ“ How to get folder path:\n\n1. Open File Explorer\n2. Navigate to the folder containing chip document files\n3. Copy the complete path from the address bar\n4. Paste it into the input box above\n\nğŸ’¡ Tips:\n- Press Ctrl+L to quickly select the address bar\n- Press Ctrl+C to copy the path\n- Press Ctrl+V to paste into the input box",
          inputRequired: "Please enter the chip document base path!",
          saveSuccess:
            "Chip document base path has been successfully saved to registry!",
          saveFailed: "Save failed! Please check IE security settings.",
          placeholder: "Example:D:\NS3608\N32H48xxx_V1.1.0",
        },
      };

      // å½“å‰è¯­è¨€
      var currentLanguage = "cn";

      // åˆ‡æ¢è¯­è¨€å‡½æ•°
      function switchLanguage() {
        var select = document.getElementById("languageSelect");
        var newLang = select.value;

        if (newLang !== currentLanguage) {
          currentLanguage = newLang;
          updateLanguage();
        }
      }

      // æ›´æ–°é¡µé¢è¯­è¨€
      function updateLanguage() {
        var lang = languageConfig[currentLanguage];

        // æ›´æ–°æ ‡é¢˜
        var title = document.querySelector(".header-section h2");
        if (title) title.textContent = lang.title;

        // æ›´æ–°ä½¿ç”¨ç›®çš„
        var purposeTitle = document.querySelector(".info-box h3");
        if (purposeTitle) purposeTitle.textContent = lang.purpose;

        var purposeText = document.querySelector(".info-box p");
        if (purposeText) purposeText.textContent = lang.purposeText;

        // æ›´æ–°ä½¿ç”¨è¯´æ˜
        var instructionsTitle = document.querySelectorAll(".info-box h3")[1];
        if (instructionsTitle)
          instructionsTitle.textContent = lang.instructions;

        var instructions = document.querySelectorAll(".info-box p");
        if (instructions.length >= 6) {
          instructions[1].textContent = lang.instruction1;
          instructions[2].textContent = lang.instruction2;
          instructions[3].textContent = lang.instruction3;
          instructions[4].textContent = lang.instruction4;
          instructions[5].textContent = lang.instruction5;
        }

        // æ›´æ–°æ ‡ç­¾
        var basePathLabel = document.querySelector('label[for="pdfPath"]');
        if (basePathLabel) basePathLabel.textContent = lang.basePathLabel;

        // æ›´æ–°æŒ‰é’®
        var browseBtn = document.querySelector(".browse-btn");
        if (browseBtn) browseBtn.textContent = lang.browseBtn;

        var saveBtn = document.querySelector(".btn");
        if (saveBtn) saveBtn.textContent = lang.saveBasePath;

        var clearBtn = document.querySelector(".btn-clear");
        if (clearBtn) clearBtn.textContent = lang.clearBasePath;

        // æ›´æ–°å½“å‰è·¯å¾„æ˜¾ç¤º
        var setBasePath = document.querySelector("#currentPath strong");
        if (setBasePath) setBasePath.textContent = lang.setBasePath;

        // æ›´æ–°è¾“å…¥æ¡†çš„placeholder
        var placeholder = document.querySelector("#pdfPath");
        if (placeholder) placeholder.placeholder = lang.placeholder;
      }

      // CHMæ•°æ®æŒä¹…åŒ–ç®¡ç†å·¥å…· - ä½¿ç”¨æ³¨å†Œè¡¨å­˜å‚¨
      var ChmStorageManager = {
        // æ³¨å†Œè¡¨è·¯å¾„
        regPath: "HKEY_CURRENT_USER\\SOFTWARE\\ChmConfig\\",

        // è·å–é¡¹ç›®åç§°ä½œä¸ºæ³¨å†Œè¡¨é”®å
        getProjectName: function () {
          // è¿™é‡Œå¯ä»¥æ ¹æ®å®é™…éœ€è¦ä¿®æ”¹é¡¹ç›®åç§°
          // ä¾‹å¦‚ï¼šNS3608, NS3610, NZ3601 ç­‰
          return "PROJECT_NAME"; // è¯·æ›¿æ¢ä¸ºå®é™…é¡¹ç›®åç§°
        },

        // åˆ›å»ºWScript.Shellå¯¹è±¡æ¥è®¿é—®æ³¨å†Œè¡¨
        createShell: function () {
          try {
            var shell = new ActiveXObject("WScript.Shell");
            console.log("âœ… WScript.Shellåˆ›å»ºæˆåŠŸ");
            return shell;
          } catch (e) {
            console.log("âŒ WScript.Shellåˆ›å»ºå¤±è´¥:", e.message);
            return null;
          }
        },

        // ä¿å­˜PDFè·¯å¾„åˆ°æ³¨å†Œè¡¨
        setPath: function (path) {
          var shell = this.createShell();
          if (shell) {
            try {
              var projectName = this.getProjectName();
              var keyName = "pdfBasePath_" + projectName;
              shell.RegWrite(this.regPath + keyName, path, "REG_SZ");
              console.log("æ³¨å†Œè¡¨å­˜å‚¨æˆåŠŸ [", projectName, "]:", path);
              return true;
            } catch (e) {
              console.log("æ³¨å†Œè¡¨å­˜å‚¨å¤±è´¥:", e.message);
              return false;
            }
          } else {
            console.log("WScript.Shellä¸å¯ç”¨");
            return false;
          }
        },

        // ä»æ³¨å†Œè¡¨è¯»å–PDFè·¯å¾„
        getPath: function () {
          var shell = this.createShell();
          if (shell) {
            try {
              var projectName = this.getProjectName();
              var keyName = "pdfBasePath_" + projectName;
              var path = shell.RegRead(this.regPath + keyName);
              if (path && path !== "") {
                console.log("ä»æ³¨å†Œè¡¨è¯»å–æˆåŠŸ [", projectName, "]:", path);
                return path;
              }
            } catch (e) {
              console.log("æ³¨å†Œè¡¨è¯»å–å¤±è´¥:", e.message);
            }
          } else {
            console.log("WScript.Shellä¸å¯ç”¨");
          }
          return null;
        },

        // æ¸…é™¤æ³¨å†Œè¡¨æ•°æ®
        clearPath: function () {
          var shell = this.createShell();
          if (shell) {
            try {
              var projectName = this.getProjectName();
              var keyName = "pdfBasePath_" + projectName;
              shell.RegDelete(this.regPath + keyName);
              console.log("æ³¨å†Œè¡¨æ•°æ®æ¸…é™¤æˆåŠŸ [", projectName, "]");
              return true;
            } catch (e) {
              console.log("æ³¨å†Œè¡¨æ¸…é™¤å¤±è´¥ï¼ˆå¯èƒ½ä¸å­˜åœ¨ï¼‰:", e.message);
              return true; // ä¸å­˜åœ¨ä¹Ÿç®—æˆåŠŸ
            }
          } else {
            console.log("WScript.Shellä¸å¯ç”¨");
            return false;
          }
        },
      };

      // æµè§ˆï¼ˆæ˜¾ç¤ºå¦‚ä½•è·å–è·¯å¾„ï¼‰
      function browseFolder() {
        var lang = languageConfig[currentLanguage];
        var message = lang.browseMessage;

        alert(message);

        // èšç„¦åˆ°è¾“å…¥æ¡†
        document.getElementById("pdfPath").focus();
      }

      // ä¿å­˜PDFè·¯å¾„åˆ°COMç»„ä»¶
      function savePdfPath() {
        var pathInput = document.getElementById("pdfPath");
        var path = pathInput.value.trim();
        var lang = languageConfig[currentLanguage];

        if (!path) {
          showMessage(lang.inputRequired, "error");
          return;
        }

        // ä¿å­˜åˆ°æ³¨å†Œè¡¨
        var success = ChmStorageManager.setPath(path);

        if (success) {
          // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
          showMessage(lang.saveSuccess, "success");
          // æ˜¾ç¤ºå½“å‰è·¯å¾„
          showCurrentPath(path);
        } else {
          showMessage(lang.saveFailed, "error");
        }
      }

      // æ¸…é™¤PDFåŸºè·¯å¾„
      function clearPdfPath() {
        var lang = languageConfig[currentLanguage];

        // æ¸…é™¤æ³¨å†Œè¡¨ä¸­çš„è·¯å¾„
        var success = ChmStorageManager.clearPath();

        if (success) {
          // æ¸…ç©ºè¾“å…¥æ¡†
          document.getElementById("pdfPath").value = "";
          // éšè—å½“å‰è·¯å¾„æ˜¾ç¤º
          document.getElementById("currentPath").style.display = "none";
          // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
          showMessage(lang.clearSuccess, "success");
        } else {
          showMessage(lang.clearFailed, "error");
        }
      }

      // æ˜¾ç¤ºå½“å‰é€‰æ‹©çš„è·¯å¾„
      function showCurrentPath(path) {
        var pathDisplay = document.getElementById("currentPath");
        var pathText = document.getElementById("pathText");

        pathText.textContent = path;
        pathDisplay.style.display = "block";
      }

      // æ˜¾ç¤ºæ¶ˆæ¯
      function showMessage(text, type) {
        var messageDiv = document.getElementById("message");
        messageDiv.textContent = text;
        messageDiv.className = "message " + type;
        messageDiv.style.display = "block";

        // 3ç§’åè‡ªåŠ¨éšè—
        setTimeout(function () {
          messageDiv.style.display = "none";
        }, 3000);
      }

      // é¡µé¢åŠ è½½å®Œæˆåæ˜¾ç¤ºå·²ä¿å­˜çš„è·¯å¾„
      window.onload = function () {
        console.log("é¡µé¢åŠ è½½å®Œæˆï¼Œè¯»å–æ³¨å†Œè¡¨å­˜å‚¨...");

        // è¯»å–å·²ä¿å­˜çš„è·¯å¾„
        var savedPath = ChmStorageManager.getPath();
        if (savedPath) {
          document.getElementById("pdfPath").value = savedPath;
          showCurrentPath(savedPath);
        }

        console.log("é¡µé¢åŠ è½½å®Œæˆï¼Œå½“å‰æ³¨å†Œè¡¨å­˜å‚¨çŠ¶æ€:", savedPath);
      };
    </script>
  </body>
</html>
